# 전등배치 원클릭 앱

KS A 3011 조도 기준 + 자동 수량 계산 + CAD 파일 자동 처리(DXF/DWG 입력, 방 인식, 배치 계산, DXF 출력) + AutoLISP(`QQQ`, `QQQALL`) 생성 기능을 제공하는 웹앱입니다.

## 주요 기능

1. **KS A 3011 조도 등급(A~K)**
   - 최저/표준/최고 선택 시 목표 조도(Lx) 자동 반영
   - 사무실/복도/창고 **프리셋 버튼** 제공(조도 + 광속 + 층고)

2. **단일 실 계산**
   - 면적, 층고, 광속, 보수율 기반 추천 수량 계산
   - 가로/세로가 비어 있고 면적만 있으면 **정사각형 가정 계산**
   - 조명 배치 **미리보기 캔버스** 제공

3. **다실 일괄 계산(CSV 입력)**
   - 실별 RI/U/추천 수량 계산 + CSV 다운로드
   - 테이블 렌더링 시 `textContent` 사용(입력값 안전 처리)

4. **AutoLISP 생성**
   - 현재 설정값 기반 `qqq_auto.lsp` 생성/다운로드
   - `QQQ`(단일), `QQQALL`(닫힌 경계 다중) 명령 포함
   - 이용률 계산 방식(계단식/보간) 선택값 반영

5. **CAD 자동 처리**
   - DXF/DWG 파일 업로드
   - 닫힌 폴리라인 기반 방 자동 인식
   - 조도 기준으로 실별 추천 수량 계산
   - 자동 배치점 생성
   - 결과를 **DXF 파일**로 다운로드 (원본 + 배치 심볼/회로 문자)
   - 출력 전 DXF 재검증 + 다운로드 안정성 개선

6. **UX 개선**
   - 카드 섹션 접기/펼치기
   - 숫자 입력 실시간 유효성 검사
   - 이용률 계산 방식(계단식/보간) 선택 가능
   - 모바일 테이블 카드형 표시(`data-label` 기반)

## 계산식

- 유효 높이: `Hm = (층고 - 850) / 1000`
- 실지수: `RI = 면적 / (Hm × (가로m + 세로m))`
- 이용률(U):
  - `RI >= 4.0 → 0.80`
  - `RI >= 2.5 → 0.75`
  - `RI >= 1.5 → 0.65`
  - `RI >= 1.0 → 0.55`
  - 그 외 `0.45`
- 추천 수량:
  - `N = ceil((목표조도 × 면적) / (광속 × U × 보수율))`

## 실행

정적 웹앱입니다.

- 로컬: `index.html` 브라우저 열기
- 배포: Vercel 정적 배포

## CAD 처리 방식

- CAD 엔진: `@mlightcad/libdxfrw-web` (WASM)
- 입력: `.dxf`, `.dwg`
- 출력: `.dxf`
- 방 인식 기준: **닫힌 LWPOLYLINE/POLYLINE** + 사용자 지정 면적 범위

## 주의

- 본 앱의 KS 조도값은 제공된 문서의 등급표 요약값입니다.
- 실제 설계 적용 전 최신 기준서/발주처 기준과 함께 최종 검토하세요.
